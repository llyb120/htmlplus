<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ç®€å•æµ‹è¯•</title>
</head>
<body>
    <h1>ç®€å•å“åº”å¼æµ‹è¯•</h1>
    <div id="app"></div>
    <div id="log"></div>

    <script src="reactive-lit.js"></script>
    <script>
        const { html, createComponent, useState } = window.ReactiveLit;
        const debug = window.__reactive_debug__;

        const logs = [];
        function log(msg) {
            logs.push(msg);
            document.getElementById('log').innerHTML = logs.map(l => `<div>${l}</div>`).join('');
        }

        // æ‹¦æˆª trigger
        const origTrigger = debug.trigger;
        debug.trigger = function(target, key) {
            log(`ğŸ”” trigger è¢«è°ƒç”¨: key="${key}", target=${Array.isArray(target) ? 'Array' : 'Object'}`);
            return origTrigger.apply(this, arguments);
        };

        createComponent('simple-test', () => {
            const count = useState(0);
            const arr = useState([1, 2]);

            return html`
                <div>
                    <h2>Count: ${count()}</h2>
                    <h2>Arr: [${arr().join(', ')}]</h2>
                    
                    <button onClick=${() => {
                        log('â”â”â” ç‚¹å‡» count++ â”â”â”');
                        count(count() + 1);
                    }}>count++</button>
                    
                    <button onClick=${() => {
                        log('â”â”â” ç‚¹å‡» arr.push â”â”â”');
                        log(`before push: [${arr()}]`);
                        arr().push(arr().length + 1);
                        log(`after push: [${arr()}]`);
                    }}>arr.push</button>
                </div>
            `;
        });

        document.getElementById('app').innerHTML = '<simple-test></simple-test>';
    </script>
</body>
</html>

